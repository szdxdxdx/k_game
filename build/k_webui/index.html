<!DOCTYPE html>
<html lang="zh">
<head>
  <title>k_webui</title>
  <meta charset="UTF-8">
  <script src="/webui.js"></script>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

  <style>

    /* region [binding-panel] */

    #binding-panel {

    }

    /* endregion */
    
    /* region [log-panel] */

    #log-panel {

    }

    /* endregion */
    
  </style>

</head>
<body>
  <div id="app">
    
    <!-- [widget-panel] --><!-- region -->

    <div id="binding-panel">

      <div v-for="[label, binding] in bindings" :key="label">

        <p>{{ binding }}</p>

        <label v-if="binding.input_type === 'range'">
          <span>{{ binding.label }}</span>
          <input type="range" @change="binding_range_set_val($event, binding.label)"/>
        </label>

        <label v-else-if="binding.input_type === 'checkbox'">
          <span>{{ binding.label }}</span>
          <input type="checkbox"/>
        </label>

      </div>

      <div>
        <label>
          <select>
            <option>1</option>
            <option>2</option>
            <option>3</option>
          </select>
        </label>
      </div>

    </div>
    
    <!-- endregion -->

    <hr>

    <!-- [log-panel] --><!-- region -->

    <div id="log-panel">
      <table>
        <tr v-for="(log, idx) in log_list" :key="idx">
          <td>
            <span>{{ log.level }}</span>
          </td>
          <td>
            <pre>{{ log.msg }}</pre>
          </td>
        </tr>
      </table>
    </div>

    <!-- endregion -->

  </div>

  <script>
    const { createApp, reactive } = Vue;

    const k__webui = createApp({
      data() {
        return {

          /* region [binding] */

          bindings: reactive(new Map()),

          /* endregion */

          /* region [log-panel] */

          log_list: [ /* { level: 'INFO|WARN|ERROR', msg } */ ],

          /* endregion */
        };
      },
      methods: {

        /* region [binding-panel] */

        bind: function(config) {
          let binding = reactive({
            label: config.label,
            input_type: config.input_type,
          });

          this.bindings.set(binding.label, binding);
        },

        unbind: function(label) {
          console.log(label);
        },

        binding_range_set_val($event, label) {
          k__webui_set_binding_C_val(label, `${$event.target.value}`);
        },

        /* endregion */

        /* region [log-panel] */

        log_info(msg) {
          this.log_list.push({ level: 'INFO', msg });
        },
        log_warn(msg) {
          this.log_list.push({ level: 'WARN', msg });
        },
        log_error(msg) {
          this.log_list.push({ level: 'ERROR', msg });
        }

        /* endregion */
      }
    }).mount('#app');
  </script>

  <script>
  </script>
</body>
</html>
