# 基础概念

## 房间

在本框架中，房间是运行游戏的场所，它承载游戏内容、组织对象、调度逻辑，并定义玩家所处的游戏环境。
在不同游戏框架或引擎中，这一概念可能被称作世界，或是场景。

以《飞机大战》为例，房间的作用可以这样理解：房间组织了飞机、敌人、子弹、背景等游戏元素，并管理它们在内存中的生命周期。同时，房间控制游戏循环，
在每轮循环内处理玩家鼠标键盘输入、更新游戏中各对象的状态。除此之外，房间还负责游戏的画面和声音呈现，例如绘制背景、绘制UI、播放背景音乐与音效等。
一个房间可以对应一个关卡或是一个界面，例如：初始房间可以是游戏的主菜单，该房间内只有一些UI元素。
开始游戏后，来到主战场房间，该房间是一个关卡，玩家在此与敌人展开对战。游戏结束后再次切换房间，该房间用于展示得分和引导下一步操作。

## 对象

在本框架中，游戏对象（或简称对象）是游戏中会发生动作的实体，它们拥有自己的属性和行为。对象只能处于房间之内，不能独立于房间而存在。

例如，《飞机大战》中，玩家角色、敌人、子弹、障碍物、金币等都可以是对象，玩家控制的飞机对象有移动、射击等行为，
而敌人对象则可能有巡逻、攻击、被击毁等行为。

注：在本文档中，“对象”一词可以指此处定义的游戏对象，也可以泛指编程语言中的抽象实体（例如面向对象语境中类的实例），具体含义需结合上下文加以判断。

## 游戏循环

“游戏循环”是游戏程序的核心机制，以下是一个简明通用的游戏循环架构示意：

```C
init();         // 初始化环境，例如：加载资源、设置初始状态等
while (running) {
    input();    // 获取输入，例如：键盘、鼠标输入、窗口消息等
    update();   // 更新游戏状态，例如：游戏对象状态更新、AI逻辑、碰撞检测等
    render();   // 渲染游戏内容到窗口，例如：绘制背景、游戏角色、UI元素等
    delay();    // 控制帧率
}
cleanup();      // 释放资源
```

这个循环从游戏开始运行，一直到玩家退出游戏或触发结束逻辑才会停止。

游戏主循环是由框架内部控制的，开发者只需要通过事件回调，来描述“在什么时候要做什么”。

## 事件回调

本框架将一个游戏过程划分为多个阶段，每个阶段都有相应的事件类型，开发者可以针对不同事件注册相应的回调函数，用于实现具体的游戏逻辑。
例如：步事件是每一帧都会触发一次的事件，你可以在步事件回调中更新游戏状态；
绘制事件也是每一帧都会触发，用于绘制房间、渲染游戏画面等；
此外还有计时器事件、进入房间事件、销毁对象事件等等。

以《飞机大战》为例，玩家可以通过按键操纵飞机对象的移动，使用本框架的实现方式是：给飞机对象注册一个步事件回调，在该回调中检测按键是否被按下，
然后修改飞机对象的坐标。框架在每个游戏帧中都会执行所有的步事件回调，从而驱动整个游戏状态向前推进。

## 组件

在本框架中，组件用于为对象的增加行为、赋予新功能。组件必须附着在对象上，不能独立于对象存在。

每个对象的设计与实现往往取决于游戏本身的业务逻辑，而每种组件则是一套行为逻辑的封装。组件是独立通用的，不依赖特定的对象。
对象可以有自身行为，也可以通过挂载组件来增加新的行为。

例如《飞机大战》中的飞机，既可以把移动的逻辑写在飞机对象的事件回调中，亦可给飞机对象挂载一个移动组件。
移动组件也有自己的事件回调，只负责根据速度更新位置，而不在乎绑定的对象是飞机对象，或是其他什么对象。

## 精灵

在本框架中，精灵归属于图片资源，它是一张静图，或是一组动画帧，用来表示游戏中的各种可见元素，例如：角色、敌人、道具等。
绝大多数游戏对象都会关联一个精灵来展示自己，精灵的职责就是把对象画出来。

以《飞机大战》游戏为例，玩家飞机对象可以关联一个飞机精灵，敌人对象则可以关联一个敌机精灵。
当然，有些对象没有外观，它们身处于幕后，控制着游戏流程，例如控制得分规则、监控玩家生命值、管理道具背包等。
